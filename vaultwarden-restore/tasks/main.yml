- name: Stop vaultwarden
  community.docker.docker_compose_v2:
    project_src: "{{ vaultwarden.installpath }}"
    state: absent
- name: Remove data dir
  file:
    path: "{{ vaultwarden.installpath }}/data"
    state: absent
- name: Folder for vaultwarden data should exist
  file:
    path: "{{ vaultwarden.installpath }}/data"
    state: directory
    mode: "0755"
- name: Copy data to vaultwarden
  copy:
    remote_src: true
    src: "{{ backup.restore_from }}/vaultwarden/"
    dest: "{{ vaultwarden.installpath }}/data/"
- name: Run vaultwarden
  community.docker.docker_compose_v2:
    project_src: "{{ vaultwarden.installpath }}"
    state: present
  register: output
- name: Notice
  ansible.builtin.debug:
    msg: "Please notice that your admin token in the inventory might be invalid, if there was a admin token in the config.json for vaultwarden."
